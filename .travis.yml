language: java
jdk: oraclejdk8

# Cache the .m2 folder and .sonar to prevent redownloading dependencies on each build
cache:
  directories:
  - $HOME/.m2/repository
  - $HOME/.sonar/cache

# Environment variables ($SONAR_TOKEN)
env:
  global:
    secure: "yUT3234Nqez5BOPOKCHZ4By4rqWpVyQr6hf3HaWqntE+0AuaFY0Wf76PgxbFInnVTFZF0amjYEYoN45vJuiuCfjxHizMDYgaTfnTNyahid4xIZQjI3e6XVjzRjJWkHp0VclJrD9yHMxEw0WPA9ip3r9nPwTcsk0eWZSUf84rcAnbMG8tMOk7q+1Hg6QLP2TkdyANZ/Exs9rHgJuG9F1I1Y6NOpHXNCdpdt6rFR2OTVbKtCEo22P5TZ6vZrzxfCAFUj5ok7lszUp+6wkbE5UddAAo0sv+bSfOCCmPtosnfWSMJAZrfTnVUyMgGOHZ2A1kAu0KYrL1c6qIwXKsfCTdyys280ITLs2IaS16a4AoETrp/nH9VB7Myl2YcLC8em1BJ5Qg0waLBjVhev2ziYiKeOuzELfIalBKWdK7U9l46/OU+AoP7XT7H8GPPDDt4nO1WmMiSSU3qOper5/kqmJ5EIrYyC2jNN86bO3CM41TTFKixF4ecdujIUTMtRCqMUIctcK7kTSwE+KDCSQFmc87vHWGgcI67APoR6djJ9Ra9IV0LqwJjI6mb1gtOQUyhWE/BcqGUgoKIMoin1m9vrWR3OlyVN2jsgfH3GescfOB46xvE8IHcQcDD4rWtUugYUBlhbPxiB71QGzy29gh8R5ykx3LTYPUfngsbENVJs6VWO8="

addons:
  sonarcloud:
    organization: "takima-training_sample-application"
    token:
      secure: $SONAR_TOKEN

# Define the services to use
services:
  - docker

before_install:
- sudo service mysql stop
- docker pull takimatraining/devops-training-db
- docker run -d -p 127.0.0.1:3306:3306 takimatraining/devops-training-db

script:
  # Run Unit Test and Integration Tests, and make SonarCloud analysis
  - mvn clean install sonar:sonar


