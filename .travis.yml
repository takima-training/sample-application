language: java
jdk: oraclejdk8

# Cache the .m2 folder and .sonar to prevent redownloading dependencies on each build
cache:
  directories:
  - $HOME/.m2/repository
  - $HOME/.sonar/cache

addons:
  sonarcloud:
    organization: "takima-training"
    token:
      secure: "EWh04CRpugU1QM7yDXyh2ad5wdmW5z59gEyIa24ow/OwFMNmvmYV69koFtdDzzeen698fJ/FzLb4I33nrWKSXqu6exqCuNe4MJizi48+rjAdQHxMjZ5MdunAXxr70ZKYt+QEAMhoYhVwr4LtDcurEZAXbFWraepDbDuVPPXFYKh8p1uesATe5xQXk9zHthJiqNG4ZBD+NmFffuzYRa8YJkd0jB0lKu6r+W98AZQek9rKCNQyn9c2gbFsnB1BtsSvo0sSR7jY7XO0/GvKW0dFUDaJtG43BDshTCvbd5EEWMeoAbb14MRBxB5r9O76LyRmu06k84l8ZBTs1hB0ucmfvc5HDu8MN1dTMpfYe87P67AOeIseCqaIWSGtV6qZZv24rha0YWvH3Mw/s3zqBPLYvSXuqsKcZCpYU5WXVwIwzcq/ogFhbksxVGpmO3unggytQYQAjpOMcYIe/u1wLRvd90/+l0yEMWM8PEWn783lXw7bu+7jdwTD1zgs14W2Lx/ABYbGDBlJwaepDkVu8bTLnKqt+MAllXGhCuqIl0ZdDPFqHM6EYvHwPMcnkqwphDWUGzkWGS0tH3+cCUEHx4cR97f5jx5fYCeRtF3IU+IJ7oyqzpC11rfOyyr9XpQ5Z7Rzx5Y5RTciTG5MAy6Gi2pBB/OJhIJ0GWau5xi38Osmrg8="

# Define the services to use
services:
  - docker

before_install:
- sudo service mysql stop
- docker pull takimatraining/devops-training-db
- docker run -d -p 127.0.0.1:3306:3306 takimatraining/devops-training-db

script:
  # Run Unit Test and Integration Tests, and make SonarCloud analysis
  - mvn clean install sonar:sonar


